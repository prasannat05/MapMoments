<section class="card auth-box">
  <h2>Welcome to Map Moments</h2>
  <form name="welcomeForm" ng-submit="submit(welcomeForm)" novalidate autocomplete="off">
    <div class="form-row">
      <span class="form-icon">ğŸ“§</span>
      <input type="email" name="email" placeholder="Email" ng-model="user.email" required ng-model-options="{ updateOn: 'blur' }" />
    </div>
    <p class="error" ng-show="(welcomeForm.email.$touched || welcomeForm.$submitted) && welcomeForm.email.$error.required">Email is required.</p>
    <p class="error" ng-show="welcomeForm.email.$dirty && welcomeForm.email.$error.email">Invalid email format.</p>

    <div class="form-row" ng-if="authMode==='register'">
      <span class="form-icon">ğŸ™</span>
      <input type="text" name="username" ng-model="user.username" placeholder="Username (min 3 chars)" required ng-minlength="3" />
    </div>
    <p class="error" ng-if="authMode==='register'" ng-show="(welcomeForm.username.$touched || welcomeForm.$submitted) && welcomeForm.username.$error.required">Username is required.</p>
    <p class="error" ng-if="authMode==='register'" ng-show="welcomeForm.username.$dirty && welcomeForm.username.$error.minlength">Username must be at least 3 chars.</p>

    <div class="form-row">
      <span class="form-icon">ğŸ”‘</span>
      <input type="password" name="password" ng-model="user.password" placeholder="Password (min 6 chars)" required ng-minlength="6" />
    </div>
    <p class="error" ng-show="(welcomeForm.password.$touched||welcomeForm.$submitted) && welcomeForm.password.$error.required">Password is required.</p>
    <p class="error" ng-show="welcomeForm.password.$dirty && welcomeForm.password.$error.minlength">Password must be at least 6 characters.</p>

    <div class="form-row" ng-if="authMode==='register'">
      <span class="form-icon">ğŸ”’</span>
      <input type="password" name="confirmPassword" ng-model="user.confirmPassword" placeholder="Confirm Password" required />
    </div>
    <p class="error" ng-if="authMode==='register'" ng-show="(welcomeForm.confirmPassword.$touched||welcomeForm.$submitted) && welcomeForm.confirmPassword.$error.required">Confirm your password.</p>
    <p class="error" ng-if="authMode==='register'" ng-show="user.confirmPassword && user.password !== user.confirmPassword">Passwords do not match.</p>

    <button type="submit">
      {{ authMode === 'login' ? 'Login' : 'Register' }}
    </button>

    <p class="error" ng-show="authError">{{authError}}</p>

    <p class="redirect">
      <a href="" ng-click="toggleMode(authMode === 'login' ? 'register' : 'login')">
        {{ authMode === 'login' ? 'Create New Account' : 'Already have an account?' }}
      </a>
    </p>

    <hr />

    <button type="button" ng-click="continueAsGuest()">Continue as Guest</button>
  </form>
</section>
